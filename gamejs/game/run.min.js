var WordGame=function(){},game=function(){};game.prototype=new Game,g=new game,JY.extend(game.prototype,{newGame:function(){this.monsterArr=[],this.level=1,this.jumpSpeed=25,this.monsterSpeed=10,this.mapSpeed=10,this.score=0,this.life=1,this.user=null,b.checkState(JYGSTATE.STATE_SYSTEM_NEW_LEVEL),this.counter=0,this.animateUserFor=0,this.animateNum=0,this.waiter=0,this.createUser(),this.BindEvent(),this.isJump=0,this.monsterType=[FixedMonster,MoveMonster],this.by=0,this.shootArr=[],this.userState=0,this.shootCount={type:"",count:0},this.shootScreen=null,this.wdScreen=null,this.createShootScreen(),this.wdTimer=0,this.wdState=0,this.userRunSpeed=3},createShootScreen:function(){this.shootScreen=JY.convertDOM('<div style="position:absolute;bottom:0;left:10px;height:30px;"></div>'),b.addChild(this.shootScreen),this.wdScreen=JY.convertDOM('<div style="position:absolute;bottom:50%;left:40%;background-Color:#98Ed66;padding:10px;border-radius:3px;border:1px solid #989898;display:none;">无敌时间</div>'),b.addChild(this.wdScreen)},formatShoot:function(){for(var t="",e=0,s=this.shootCount.count;s>e;e++)"red"==this.shootCount.type&&(t+='<img src="images/run/fixshoot.png" width="30px"/>'),"blue"==this.shootCount.type&&(t+='<img src="images/run/moveshoot.png" width="30px"/>');this.shootScreen.innerHTML=t,JY.css(this.shootScreen,{display:"block"}),3==this.shootCount.count&&"red"==this.shootCount.type&&(this.monsterSpeed*=2,this.mapSpeed*=2,this.userRunSpeed=2,JY.css(this.wdScreen,{display:"block"}),this.wdState=1,this.wdTimer=200,this.user.setStyle({opacity:.8,filter:"alpha(opacity=60)"}))},runGame:function(){this.moveBack(),this.checkLife(),this.checkLevel(),this.createMonster(),this.moveUser(),this.playUser(),this.testShoot()},testShoot:function(){var t=this;JY.resolve(function(e,s){this.x+=this.svx,this.y+=this.svy,this.setPosition(this.x,this.y),JY.hits(this,t.user)&&(0!=t.userState?(t.score+=100,this.data==t.shootCount.type&&t.shootCount.count<3?(t.shootCount.count++,t.formatShoot()):this.data!==t.shootCount.type&&(t.shootCount.type=this.data,t.shootCount.count=1,t.formatShoot())):0==t.wdState?t.life--:t.score+=100,b.removeChild(e),delete t.shootArr[s]),(this.x<0||this.x>JY.width(b.stage)||this.y<0||this.y>JY.height(b.stage))&&(b.removeChild(e),delete t.shootArr[s])},0,t.shootArr.length,t.shootArr)},MoveMonster:function(){var t=this;JY.resolve(function(e,s){e.move(t.shootArr).dispose(function(){b.removeChild(t.monsterArr[s]),delete t.monsterArr[s]}),JY.hits(t.user,this)&&(1==this.type&&(0==t.wdState?t.life--:t.score+=300),2==this.type&&(0!=t.userState||1==t.wdState?t.score+=300:t.life--),b.removeChild(t.monsterArr[s]),delete t.monsterArr[s])},0,t.monsterArr.length,t.monsterArr)},moveBack:function(){JY.css(JY.parent(b.stage),{backgroundPosition:"0 "+this.by+"px"}),this.by+=this.mapSpeed,this.by>JY.height(b.stage)&&(this.by=0),this.MoveMonster()},createMonster:function(){var t=Math.floor(100*Math.random());if(this.counter+10*this.level>50+t){var e,s=Math.floor(100*Math.random());e=s>30?new this.monsterType[0]:new this.monsterType[1],e.vx=this.mapSpeed,e.vy=this.monsterSpeed,e.range={x:{min:0,max:JY.width(b.stage)-e.width},y:{min:0,max:JY.height(b.stage)}},e.game=b,e._init(),b.addChild(e),this.monsterArr.push(e),this.counter=0}this.counter++},createUser:function(){this.user=new Sprite(71,60,{border:"none",background:"url(images/run/run.png) no-repeat"}),this.user.init(),b.addChild(this.user),this.user.setPosition(0,JY.height(b.stage)-this.user.height)},moveUser:function(){if(this.isJump){if(this.mapSpeed=8,1==this.animateUserFor){var t=this.user.x+this.jumpSpeed;this.user.setPosition(t)}else{var t=this.user.x-this.jumpSpeed;this.user.setPosition(t)}(this.user.x<=0||this.user.x>=JY.width(b.stage)-this.user.width)&&(this.isJump=!1,this.mapSpeed=6,this.userState=0,this.user.setStyle({background:"url(images/run/run.png) no-repeat"}))}else if(this.user.y>2*JY.width(b.stage)/3){var e=this.user.y-this.mapSpeed;this.user.setPosition(null,e)}this.wdState&&(this.wdTimer>0?this.wdTimer--:(this.monsterSpeed/=3,this.mapSpeed/=3,this.userRunSpeed=3,JY.css(this.wdScreen,{display:"none"}),JY.css(this.shootScreen,{display:"none"}),this.wdState=0,this.user.setStyle({opacity:1,filter:"alpha(opacity=100)"}),this.shootCount={type:"",count:0}))},playUser:function(){if(this.waiter%this.userRunSpeed==0&&0==this.isJump){var t=71*-this.animateUserFor,e=100*-this.animateNum-15;JY.css(this.user.DOM,{backgroundPosition:t+"px "+e+"px"}),this.animateNum>2&&(this.animateNum=0),this.animateNum++}this.waiter++},BindEvent:function(){JY.bind(document,"keydown",JY.proxyFunc(this.listenEvent,this)),JY.bind(b.stage,"mousedown",JY.proxyFunc(this.listenEvent,this))},listenEvent:function(t){0==this.isJump&&this.jump()},disposeEvent:function(){JY.unbind(document,"keydown",JY.proxyFunc(this.listenEvent,this)),JY.unbind(b.stage,"click",JY.proxyFunc(this.listenEvent,this)),JY.unbind(b.stage,"mousedown",JY.proxyFunc(this.listenEvent,this))},jump:function(){this.isJump=1,0==this.userState?this.userState=1:null,this.user.setStyle({background:"url(images/run/jump.png) 0 0 no-repeat"}),0===this.animateUserFor?(this.animateUserFor=1,JY.css(this.user.DOM,{backgroundPosition:"0 -67px"})):(this.animateUserFor=0,JY.css(this.user.DOM,{backgroundPosition:"0 0px"}))},checkLevel:function(){b.scoreScreen.innerHTML="得分："+this.score,this.score/this.level>1e3&&(this.level++,this.mapSpeed++,this.monsterSpeed++)},checkLife:function(){this.life<=0&&(b.gameOverScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;width:500px;margin:0 auto;"><h1>您的得分是：<strong>'+this.score+'</strong> 分</h1><p>点击重新开始游戏</p><p>更多游戏请<a href="http://www.lovewebgames.com">点击这里</a></p><div>'),b.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER),this.disposeEvent())}}),WordGame.prototype=new JYG(JY.byId("gameboard")),JY.extend(WordGame.prototype,{init:function(){this.frequency=50,this.game=g,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;margin:0 auto;"><h1>极速奔跑跳跃</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;width:300px;margin:0 auto;"><h1>极速奔跑跳跃</h1><p>点击开始游戏</p><p>按键英雄跳跃<a href="http://www.lovewebgames.com" target="_blank">作者：田想兵55342775@qq.com</a></p></div>'),this.scoreScreen=JY.convertDOM('<div style="color:#555;width:100px;float:right;" id="scoreScreen"></div>');var t=JY.convertDOM('<p style="font-size:12px;">资源正在加载中。。。</p>');this.addChild(t);var e=this;JY.loadFile("images/run/fixMonster.png,images/run/fixshoot.png,images/run/jump.png,images/run/moveMonster.png,images/run/moveshoot.png,images/run/run.png","image",function(){e.removeChild(t)})}});var b=new WordGame;JY.loadFile("Monster.js","script",function(){b.init()}),"www.lovewebgames.com"!==location.host&&"localhost"!==location.hostname&&"jsjy.cloudfoundry.com"!=location.host&&(location.href="http://www.lovewebgames.com");