var WordGame=function(){},game=function(){this.goldArr=[],this.level=1,this.speed=10,this.score=0,this.life=1};game.prototype=new Game,g=new game,JY.extend(game.prototype,{newGame:function(){this.goldArr=[],this.level=1,this.speed=10,this.score=0,this.life=1,b.checkState(JYGSTATE.STATE_SYSTEM_NEW_LEVEL),this.user=this.createUser(),this.userSpeed=30,this.goldSort=[5,10,50,100,-1]},createUser:function(){var e=new Sprite(155,125);e.direction=0;var t=(JY.width(b.stage)-e.width)/2,i=JY.height(b.stage)-e.height;return e.setPosition(t,i),e.DOM.innerHTML="",JY.addClass(e.DOM,"user"),b.addChild(e.DOM),e},moveUser:function(e){switch(e){case 39:this.user.x+=this.userSpeed,this.user.x=Math.min(this.user.x,JY.width(b.stage)-this.user.width),this.user.setPosition(this.user.x,this.user.y);break;case 37:this.user.x-=this.userSpeed,this.user.x=Math.max(this.user.x,0),this.user.setPosition(this.user.x,this.user.y)}},runGame:function(){this.creaetWord(),this.moveWord(),this.killWord(),this.checkLife(),this.checkLevel()},checkLevel:function(){b.scoreScreen.innerHTML="得分："+this.score,this.score/this.level>100*this.level&&(this.level++,this.speed*=1.1)},checkLife:function(){this.life<=0&&(b.gameOverScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;width:500px;margin:0 auto;"><h2>疯狂的接金币最后得分是：<strong>'+this.score+"</strong>分</h2><p>点击重新开始游戏</p><div>"),b.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER))},moveWord:function(){var e=this;JY.resolve(function(t,i){t.y+=e.speed,t.setPosition(t.x,t.y),t.y>JY.height(b.stage)&&(b.removeChild(t.DOM),delete t)},0,this.goldArr.length,this.goldArr)},creaetWord:function(){var e=Math.floor(100*Math.random());if(e<this.level+10){var t=new Sprite(30,30);t.direction=0;var i=Math.random()*(JY.width(b.stage)-t.width);t.setPosition(i,-30),t.data=this.goldSort[Math.floor(5*Math.random())],t.DOM.innerHTML=t.data,-1===t.data?JY.addClass(t.DOM,"zd"):JY.addClass(t.DOM,"gold"),b.addChild(t.DOM),this.goldArr.push(t)}},killWord:function(){var e=this;JY.each(this.goldArr,function(t,i){return e.user.x<=t.x&&e.user.x+e.user.width>=t.x&&t.y>=e.user.y&&t.y<=e.user.y+t.height?-1==t.data?void e.life--:(e.score+=t.data,b.removeChild(this.DOM),void delete e.goldArr[i]):void 0})}}),WordGame.prototype=new JYG(JY.byId("gameboard")),JY.extend(WordGame.prototype,{init:function(){this.game=g,this.frequency=50,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:#555;padding:200px;width:300px;margin:0 auto;"><h1>疯狂的接金币</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="color:#555;padding:200px;width:300px;margin:0 auto;"><h1>疯狂的接金币</h1><p>点击开始游戏</p><p>方向键左右移动角色接金获取得分</p><a>作者：田想兵</a>55342775@qq.com</div>'),this.scoreScreen=JY.convertDOM('<div style="color:#555;width:100px;float:right;" id="scoreScreen"></div>'),JY.bind(document,"keydown",function(e){g.moveUser(e.keyCode)}),JY.delegate(this.stage,"i","click",function(e){g.killWord(e.target)}).delegate(this.stage,"i","mouseover",function(e){g.killWord(e.target)})}});var b=new WordGame;b.init();