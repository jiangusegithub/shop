var WordGame=function(){},game=function(){this.goldArr=[],this.level=1,this.speed=10,this.score=0,this.life=1};game.prototype=new Game,g=new game,JY.extend(game.prototype,{newGame:function(){this.goldArr=[],this.level=1,this.speed=10,this.score=0,this.life=1,this.timer=+new Date,b.checkState(JYGSTATE.STATE_SYSTEM_NEW_LEVEL),this.user=this.createUser(),this.userSpeed=30,this.goldSort=[5,10,50,100,-1]},createUser:function(){var e=new Sprite(15,15);e.direction=0;var t=(JY.width(b.stage)-e.width)/2,i=JY.height(b.stage)-e.height;e.setPosition(t,i),e.DOM.innerHTML=e.data,JY.addClass(e.DOM,"user"),b.addChild(e.DOM);var s=this;return JY.bind(b.stage,"mousemove",function(e){s.moveUser(e)}),JY.css(b.stage,{cursor:"none"}),e},moveUser:function(e){var t=e.clientX-JY.offset(b.stage).x+document.documentElement.scrollLeft,i=e.clientY-JY.offset(b.stage).y+document.documentElement.scrollTop;this.user.setPosition(t,i)},runGame:function(){this.creaetWord(),this.moveWord(),this.checkLife(),this.checkLevel()},checkLevel:function(){this.score=Math.floor((+new Date-this.timer)/1e3),b.scoreScreen.innerHTML="时间："+this.score+"s",this.score/this.level>=5&&(this.level++,this.speed*=1.1)},checkLife:function(){this.life<=0&&(b.gameOverScreen=JY.convertDOM('<div style="color:yellow;padding:200px 100px;width:500px;margin:0 auto;"><h2 style="color:yellow;">作为一个男人，你最后只坚持了<strong>'+this.score+"</strong>秒</h2><p>点击重新开始游戏</p><div>"),b.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER),JY.css(b.stage,{cursor:"default"}))},moveWord:function(){var e=this;JY.resolve(function(t,i){t.x+=Math.sin(t.data.angle)*e.speed,t.y+=Math.cos(t.data.angle)*e.speed,t.setPosition(t.x,t.y),JY.hits(t,e.user)&&e.life--,(t.y>b.stage.height||t.y<0||t.x<0||t.x>b.stage.width)&&(b.removeChild(t.DOM),delete t,delete e.goldArr[i])},0,this.goldArr.length,this.goldArr)},creaetWord:function(){var e=Math.floor(100*Math.random());if(e<10*this.level){var t=new Sprite(5,5);t.direction=0;var i=Math.random()*(b.stage.width-t.width),s=Math.floor(3*Math.random()),o=t.height;switch(s){case 1:o=b.stage.height-t.height;break;case 2:o=Math.random()*(b.stage.height-t.height),i=t.width;break;case 3:o=Math.random()*(b.stage.height-t.height),i=b.stage.width-t.width}t.setPosition(i,o),t.data={x:this.user.x,y:this.user.y};var r=t.data.x-t.x,a=t.data.y-t.y,h=Math.atan2(r,a);t.data.angle=h,t.DOM.innerHTML=t.data,JY.addClass(t.DOM,"enemy"),b.addChild(t.DOM),this.goldArr.push(t)}}}),WordGame.prototype=new JYG(JY.byId("gameboard")),JY.extend(WordGame.prototype,{init:function(){this.game=g,this.frequency=30,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:yellow;padding:200px;width:300px;margin:0 auto;"><h1 style="color:yellow;">太空惊险60秒</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="color:#efefef;padding:200px;width:300px;margin:0 auto;"><h1 style="color:yellow;">太空惊险60秒</h1><p>点击开始游戏</p><p>鼠标移动角色躲避敌人</p><a>作者：田想兵</a>55342775@qq.com</div>'),this.scoreScreen=JY.convertDOM('<div style="color:#efefef;width:100px;float:right;" id="scoreScreen"></div>')}});var b=new WordGame;b.init();