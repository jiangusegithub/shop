!function(t){var i=function(){},e=function(){};e.prototype=new Game,g=new e,JY.extend(e.prototype,{newGame:function(){this.ropeArr=[],this.level=1,this.speed=.8,this.userSpeed=10,this.gravity=.2,this.map=JY.getCtx("map"),this.score=0,this.life=1,this.power=10,this.resistance=5,this.currentLine=null,this.way=1,this.len=0,this.angel=90,this.RightTopPoint=60,this.LeftTopPoint=120,this.drawMap(),this.createUser(),s.checkState(JYGSTATE.STATE_SYSTEM_NEW_LEVEL),this.Event()},runGame:function(){if(this.currentLine)if(1==this.way){this.map.clearRect(this.currentLine.s-this.currentLine.l/2-5,0,this.currentLine.l+10,this.currentLine.l+5),this.angel<this.RightTopPoint?(this.RightTopPoint+=this.resistance,this.way=-1):this.angel=this.angel-this.speed,this.RightTopPoint>90&&(this.angel=90);var t=Math.PI*this.angel/180;this.map.beginPath(),this.map.moveTo(this.currentLine.s,0);var i=this.currentLine.s+Math.cos(t)*this.currentLine.l,e=Math.sin(t)*this.currentLine.l;this.map.lineTo(i,e),this.user.setPosition(i-this.user.width/2,e-this.user.height),this.user.setStyle({background:"url(images/Tarzan/user.png) no-repeat"}),this.map.closePath(),this.map.stroke()}else{this.map.clearRect(this.currentLine.s-this.currentLine.l/2-5,0,this.currentLine.l+10,this.currentLine.l+5),this.angel>this.LeftTopPoint&&(this.way=1,this.LeftTopPoint-=this.resistance),this.angel=this.angel+this.speed,this.LeftTopPoint<90&&(this.angel=90);var t=Math.PI*this.angel/180;this.map.beginPath(),this.map.moveTo(this.currentLine.s,0);var i=this.currentLine.s+Math.cos(t)*this.currentLine.l,e=Math.sin(t)*this.currentLine.l;this.map.lineTo(i,e),this.user.setPosition(i-this.user.width/2,e-this.user.height),this.user.setStyle({background:"url(images/Tarzan/user2.png) no-repeat"}),this.map.closePath(),this.map.stroke()}this.vx>1&&(this.user.x+=this.vx*this.way,this.vy+=this.gravity,this.user.y+=this.vy,this.user.setPosition()),this.checkHits()},checkHits:function(){for(var t=this,i=0;5>i;i++){var e=t.ropeArr[i];if(e!=t.currentLine&&Math.abs(t.user.x-e.s)<20&&Math.abs(t.user.y-e.l)<20)return t.currentLine=e,!1}},drawMap:function(){for(var t=100;t--;){var i=this.ropeArr.slice(-1)[0]||{s:0},e=Math.floor(150*Math.random())+150+i.s,s=Math.floor(300*Math.random())+100,r={s:e,l:s};this.ropeArr.length?null:r.s=5,this.ropeArr.push(r),this.drawLine(r)}},createUser:function(){this.user=new Sprite(24,24),this.user.setStyle({background:"url(images/Tarzan/user.png) no-repeat"}),s.addChild(this.user),this.user.setPosition(this.ropeArr[0].s-this.user.width,this.ropeArr[0].l-this.user.height),this.currentLine=this.ropeArr[2],this.len=this.currentLine.l,this.ox=this.currentLine.s},Event:function(){var t=this;JY.bind(s.stage,"mousedown",JY.proxyFunc(this.jump,t)),JY.bind(s.stage,"keydown",JY.proxyFunc(this.jump,t))},jump:function(){this.vy=-this.userSpeed*(this.user.x-this.ox)/this.len;var t=Math.sqrt(this.len*this.len-(this.user.x-this.ox)*(this.user.x-this.ox));return this.vx=this.userSpeed*t/this.len,this.currentLine=null,!1},drawLine:function(t){this.map.moveTo(t.s,0),this.map.strokeStyle="#00fc00",this.map.lineWidth=2,this.map.lineCap="round",this.map.lineTo(t.s,t.l),this.map.stroke()},checkLife:function(){this.life<=0&&(s.gameOverScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;width:500px;margin:0 auto;"><h1>您的最后得分是：<strong>'+this.score+"</strong>分</h1><p>点击重新开始游戏</p><div>"),s.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER))}}),i.prototype=new JYG(JY.byId("gameboard")),JY.extend(i.prototype,{init:function(){this.game=g,this.frequency=25,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:red;font-weight:bold;text-align:center;padding-top:50px;width:100%;margin:0 auto;"><h1 style="color:red;font-weight:bold;">人猿泰山-JY游戏</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="margin:0 auto;height:100%;width:640px;margin:0 auto;position:relative;"><span style="display:block;cursor:pointer;width:275px;height:110px;line-height:100px;font-family: Tahoma,宋体;text-align:center;font-size:28px;font-weight:bolder;color:#FFFFFF;top:200px;left:180px;position:absolute;">Play</span><p style="position:absolute;top:350px;left:180px;color:#0091e0;"><a href="http://www.lovewebgames.com" target="_blank" style="color:#0091e0;">作者：田想兵55342775@qq.com</a></p></div>'),this.scoreScreen=JY.convertDOM('<div style="color:#555;width:100px;float:right;" id="scoreScreen"></div>')}});var s=new i;s.init(),"www.lovewebgames.com"!==location.host&&"localhost"!==location.hostname}(window);