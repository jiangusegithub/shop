JY.ready(function(){var e=JY.query("[name='rtype']:checked").value;JY.query("[name='rtype']").bind("click",function(){return e=this.value,!0});var t=null,n=[],o=[],i={path:{},position:{}},a=JY.byId("path").getContext("2d");a.fillStyle="gray",JY.bind("gameboard","mousedown",function(o){if("path"==e)if(t){if(n[n.length-1].push({start:t,end:{x:o.offsetX,y:o.offsetY}}),t={x:o.offsetX,y:o.offsetY},2==o.button)return t=null,i.path=n,void(JY.byId("result").innerHTML=JSON.stringify(i))}else n.push([]),t={x:o.offsetX,y:o.offsetY};else"location"==e&&(t={x:o.offsetX,y:o.offsetY},r(!0))});var f=function(){for(var e=0,t=n.length;t>e;e++)for(var o=n[e],i=o.length;i--;){var f=o[i];a.beginPath(),a.moveTo(f.start.x,f.start.y),a.lineTo(f.end.x,f.end.y),a.stroke()}};JY.bind(document,"mousemove",function(n){"path"==e&&t&&(a.save(),a.clearRect(0,0,640,640),a.restore(),f(),a.beginPath(),a.moveTo(t.x,t.y),a.lineTo(n.offsetX,n.offsetY),a.stroke())}),JY.bind("gameboard","mouseup",function(n){"location"==e&&(end={x:n.offsetX+JY.byId("txt_width").value,y:n.offsetY+JY.byId("txt_height").value},r(!1),t=null)});var r=function(e){if(e){var n=JY.byId("txt_width").value,a=JY.byId("txt_height").value,f=new Sprite(n,a,{background:"white"});f.setPosition(t.x,t.y),JY.append(JY.byId("gameboard"),f.DOM),o.push({x:t.x,y:t.y,w:n,h:a}),i.position=o,JY.byId("result").innerHTML=JSON.stringify(i)}}});