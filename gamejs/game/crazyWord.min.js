var WordGame=function(){},game=function(){this.wordArr=[],this.killedArr=[],this.level=1,this.speed=10,this.score=0,this.life=1};game.prototype=new Game,g=new game,JY.extend(game.prototype,{newGame:function(){this.wordArr=[],this.level=1,this.speed=8,this.score=0,this.life=1,b.checkState(JYGSTATE.STATE_SYSTEM_NEW_LEVEL)},runGame:function(){this.creaetWord(),this.moveWord(),this.checkLife(),this.checkLevel()},checkLevel:function(){b.scoreScreen.innerHTML="得分："+this.score,this.score/this.level>5&&(this.level++,this.speed*=1.1)},checkLife:function(){this.life<=0&&(b.gameOverScreen=JY.convertDOM('<div style="color:#555;padding:200px 100px;width:500px;margin:0 auto;"><h1>您的最后得分是：<strong>'+this.score+"</strong>分</h1><p>点击重新开始游戏</p><div>"),b.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER))},moveWord:function(){var e=this;JY.resolve(function(t,i){this.y+=e.speed;var r=Math.random();e.level>2&&.01>r&&(this.direction?this.direction*=-1:this.direction=e.speed/2),this.x<=0&&(this.direction=e.speed),this.x>=JY.width(b.stage)-this.width&&(this.direction=-1*e.speed),this.x+=this.direction,this.setPosition(this.x,this.y),this.y>JY.height(b.stage)&&(b.removeChild(e.wordArr[i].DOM),e.life--,delete e.wordArr[i])},0,this.wordArr.length,this.wordArr),JY.resolve(function(t,i){this.y-=2*e.speed,this.x<JY.width(b.stage)/2?this.x-=2*e.speed:this.x+=2*e.speed,this.setPosition(this.x,this.y),(this.y<0||this.x<0||this.x>JY.width(b.stage))&&(b.removeChild(e.killedArr[i].DOM),delete e.killedArr[i])},0,e.killedArr.length,e.killedArr)},creaetWord:function(){var e=Math.floor(100*Math.random());if(e<this.level+5){var t=new Sprite(30,30);t.direction=0;var i=Math.random()*(JY.width(b.stage)-t.width);t.setPosition(i,-30),t.data=Math.floor(26*Math.random())+65,t.DOM.innerHTML=String.fromCharCode(t.data),b.addChild(t.DOM),this.wordArr.push(t)}},checkWord:function(e){var t=this;JY.each(this.wordArr,function(i,r){return e===i.data?(t.killedArr.push(t.wordArr[r]),delete t.wordArr[r],void t.score++):void 0})},killWord:function(e){var t=this;JY.each(this.wordArr,function(i,r){return e===i.DOM?(t.killedArr.push(t.wordArr[r]),delete t.wordArr[r],void t.score++):void 0})}}),WordGame.prototype=new JYG(JY.byId("gameboard")),JY.extend(WordGame.prototype,{init:function(){this.game=g,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:#555;padding:200px;width:200px;margin:0 auto;"><h1>打字游戏</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="color:#555;padding:200px;width:300px;margin:0 auto;"><h1>打字游戏</h1><p>点击开始游戏</p><p>根据屏幕出现的字母按键得分！</p>by <a href="http://shop.telidh.cn">想你所想</a></div>'),this.scoreScreen=JY.convertDOM('<div style="color:#555;width:100px;float:right;" id="scoreScreen"></div>'),JY.bind(document,"keydown",function(e){g.checkWord(e.keyCode)}),JY.delegate(this.stage,"i","click",function(e){g.killWord(e.target)}).delegate(this.stage,"i","mouseover",function(e){g.killWord(e.target)})}});var b=new WordGame;b.init();
