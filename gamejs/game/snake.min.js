var Snake=function(){};Snake.prototype=new Sprite,JY.extend(Snake.prototype,{create:function(){this.init(5,5,{backgroundColor:"#FFFFFF"})}});var WordGame=function(){},game=function(){};game.prototype=new Game,g=new game,JY.extend(game.prototype,{newGame:function(){this.snakeArr=[],this.life=1,this.speed=5,this.vx=0,this.vy=0,this.score=0,this.monster=null,this.tmpArr=[],this.createSnake(),JY.soundManage.play("bg",!0)},runGame:function(){this.createMonster(),this.run(),this.testHits(),this.checkLife()},testHits:function(){var t=this;JY.resolve(function(e,i){i>1&&JY.hits(e,t.snakeArr[0])&&t.life--},0,t.snakeArr.length,t.snakeArr)},checkLife:function(){if(this.life<=0){this.speed=0;var t=this;setTimeout(function(){b.gameOverScreen=JY.convertDOM('<div style="color:#FFFFFF;padding:0px 0px;width:400px;margin:0 auto;"><h2 style="color:#FFFFFF;">恭喜你，你挂了。你的最后得分：<strong>'+t.score+"</strong>分</h2><p>刷新页面重新开始游戏</p><div>"),b.checkState(JYGSTATE.STATE_SYSTEM_GAME_OVER)},3e3)}},createSnake:function(){this.speed=5;var t=new Snake;t.create(),t.setPosition(Math.floor((JY.width(b.stage)-t.width)/2),Math.floor((JY.height(b.stage)-t.height)/2)),b.addChild(t),this.snakeArr.push(t);var e=new Snake;e.create(),e.setPosition(Math.floor((JY.width(b.stage)-e.width)/2)-e.width,Math.floor((JY.height(b.stage)-e.height)/2)),b.addChild(e),this.snakeArr.push(e)},createMonster:function(){if(!this.monster){this.monster=new Sprite,this.monster.init(5,5,{backgroundColor:"#FFFFFF"});var t=Math.floor(Math.random()*JY.width(b.stage)),e=Math.floor(Math.random()*JY.height(b.stage));this.monster.setPosition(t,e),b.addChild(this.monster)}},run:function(){if(0!=this.speed){this.vx||this.vy||(this.vx=this.speed);var t=this,e=t.snakeArr[0];if(t.tmpArr.length=0,t.tmpArr.push({ox:e.x,oy:e.y}),e.setPosition(t.vx+e.x,t.vy+e.y),JY.each(t.snakeArr,function(e,i){if(0!==i){t.tmpArr.push({ox:e.x,oy:e.y});var o=t.tmpArr[i-1];e.setPosition(o.ox,o.oy)}}),JY.hits(e,t.monster,-1)){var i=new Snake;i.create();var o=t.snakeArr[t.snakeArr.length-1].x,n=t.snakeArr[t.snakeArr.length-1].y;i.setPosition(o,n),b.addChild(i),t.snakeArr.push(i),b.removeChild(t.monster),delete t.monster,t.score++,b.scoreScreen.innerHTML=t.score,JY.soundManage.play("shit",!1)}e.x>=JY.width(b.stage)&&(e.x=JY.width(e.DOM)),e.x<=-JY.width(e.DOM)&&(e.x=JY.width(b.stage)-JY.width(e.DOM)),e.y>=JY.height(b.stage)+JY.height(e.DOM)&&(e.y=JY.height(e.DOM)),e.y<=-JY.height(e.DOM)&&(e.y=JY.height(b.stage)-JY.height(e.DOM))}},bindEvent:function(t){var e=this,i=e.snakeArr[0],o=e.snakeArr[1];switch(t){case 38:case 87:o&&i.x===o.x||(e.vx=0,e.vy=-1*e.speed);break;case 40:case 83:o&&i.x===o.x||(e.vx=0,e.vy=1*e.speed);break;case 37:case 65:o&&i.y===o.y||(e.vy=0,e.vx=-1*e.speed);break;case 39:case 68:o&&i.y===o.y||(e.vy=0,e.vx=1*e.speed)}return!0}}),WordGame.prototype=new JYG(JY.byId("gameboard")),JY.extend(WordGame.prototype,{init:function(){var t=this;JY.bind("tabSpeed","click",function(e){t.clearState(),t.frequency=50,t.game=g,t.waitTime=5,t.checkState(JYGSTATE.STATE_SYSTEM_TITLE),t.startTimer()}),this.frequency=80,this.game=g,this.waitTime=5,this.checkState(JYGSTATE.STATE_SYSTEM_TITLE),this.startTimer(),this.titleScreen=JY.convertDOM('<div style="color:red;font-weight:bold;text-align:center;padding-top:50px;width:100%;margin:0 auto;"><h1 style="color:red;font-weight:bold;">吞食蛇永恒激情版-JY游戏</h1></div>'),this.InstructionsScreen=JY.convertDOM('<div style="margin:0 auto;height:100%;width:100%;position:relative;"><span style="display:block;cursor:pointer;width:275px;height:110px;line-height:100px;font-family: Tahoma,宋体;text-align:center;font-size:28px;font-weight:bolder;color:#FFFFFF;top:50px;left:20px;position:absolute;">Play</span><p style="position:absolute;top:150px;left:80px;"><a href="http://www.lovewebgames.com" target="_blank" style="color:#fff797;">作者：田想兵55342775@qq.com</a></p></div>'),this.scoreScreen=JY.convertDOM('<div style="color:#FFF;width:200px;float:right;font-weight:bold;position:absolute;z-index:2;right:0;" id="scoreScreen"></div>'),JY.delegate(JY.byId("gameboard"),"a","mousedown",function(t){location.href=JY.attr(t.target,"href")}),JY.soundManage.init("/scripts/swfobject.min.js","/scripts/flash/playSound.swf","playSound",function(){JY.soundManage.loadSound("sound/zuma/bg.mp3","bg"),JY.soundManage.loadSound("sound/zuma/shit.mp3","shit")}),JY.bind(document,"keydown",function(t){g.bindEvent(t.keyCode)})}});var b=new WordGame;b.init(),"www.lovewebgames.com"!==location.host&&"localhost"!==location.hostname&&"jsjy.cloudfoundry.com"!=location.host&&(location.href="http://www.lovewebgames.com");